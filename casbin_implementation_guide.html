<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PKMS Casbin æƒé™æ§åˆ¶ç³»ç»Ÿå®ç°æŒ‡å—</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 40px;
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 40px;
            margin-bottom: 20px;
        }
        
        h3 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .highlight {
            background: linear-gradient(120deg, #a8e6cf 0%, #dcedc8 100%);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #27ae60;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        pre {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.4;
        }
        
        code {
            background: #f1f3f4;
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 14px;
            color: #e74c3c;
        }
        
        .file-tree {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .api-endpoint {
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .step {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }
        
        .step-number {
            background: #007bff;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -15px;
            left: 20px;
            font-weight: bold;
        }
        
        .architecture {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.2s;
        }
        
        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .checkmark {
            color: #28a745;
            font-weight: bold;
        }
        
        .toc {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            padding: 5px 0;
        }
        
        .toc a {
            color: #007bff;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” PKMS Casbin æƒé™æ§åˆ¶ç³»ç»Ÿå®ç°æŒ‡å—</h1>
        
        <div class="highlight">
            <strong>å®ç°çŠ¶æ€ï¼š</strong> âœ… å®Œæˆ &nbsp;&nbsp;&nbsp;
            <strong>å®ç°æ—¶é—´ï¼š</strong> 2024å¹´ &nbsp;&nbsp;&nbsp;
            <strong>åŠŸèƒ½å®Œæ•´åº¦ï¼š</strong> 100%
        </div>

        <div class="toc">
            <h3>ğŸ“‹ ç›®å½•</h3>
            <ul>
                <li><a href="#overview">1. å®ç°æ¦‚è¿°</a></li>
                <li><a href="#architecture">2. ç³»ç»Ÿæ¶æ„</a></li>
                <li><a href="#implementation">3. è¯¦ç»†å®ç°è¿‡ç¨‹</a></li>
                <li><a href="#files">4. å…³é”®æ–‡ä»¶è¯´æ˜</a></li>
                <li><a href="#api">5. API æ¥å£æ–‡æ¡£</a></li>
                <li><a href="#frontend">6. å‰ç«¯å®ç°</a></li>
                <li><a href="#usage">7. ä½¿ç”¨è¯´æ˜</a></li>
                <li><a href="#deployment">8. éƒ¨ç½²æŒ‡å—</a></li>
                <li><a href="#summary">9. æ€»ç»“</a></li>
            </ul>
        </div>

        <h2 id="overview">ğŸ¯ 1. å®ç°æ¦‚è¿°</h2>
        
        <p>æœ¬æ¬¡å®ç°ä¸º PKMS é¡¹ç›®æˆåŠŸé›†æˆäº† <strong>Casbin æƒé™æ§åˆ¶ç³»ç»Ÿ</strong>ï¼Œæä¾›äº†å®Œæ•´çš„åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰åŠŸèƒ½ã€‚ç³»ç»Ÿæ”¯æŒç”¨æˆ·ã€è§’è‰²ã€æƒé™çš„çµæ´»ç®¡ç†ï¼Œå¹¶ä¸ºæ‰€æœ‰ API æ¥å£æä¾›äº†æƒé™éªŒè¯ã€‚</p>

        <div class="feature-grid">
            <div class="feature-card">
                <h4><span class="checkmark">âœ…</span> æƒé™æ§åˆ¶æ ¸å¿ƒ</h4>
                <p>Casbin ç®¡ç†å™¨ã€RBAC æ¨¡å‹é…ç½®ã€æƒé™ç­–ç•¥ç®¡ç†</p>
            </div>
            <div class="feature-card">
                <h4><span class="checkmark">âœ…</span> ä¸­é—´ä»¶ç³»ç»Ÿ</h4>
                <p>æƒé™éªŒè¯ä¸­é—´ä»¶ã€å¤šç§éªŒè¯æ–¹å¼ã€æ™ºèƒ½åŸŸæå–</p>
            </div>
            <div class="feature-card">
                <h4><span class="checkmark">âœ…</span> API æ¥å£</h4>
                <p>å®Œæ•´çš„æƒé™ç®¡ç† APIã€ç­–ç•¥ç®¡ç†ã€è§’è‰²ç®¡ç†</p>
            </div>
            <div class="feature-card">
                <h4><span class="checkmark">âœ…</span> å‰ç«¯ç•Œé¢</h4>
                <p>å¯è§†åŒ–æƒé™ç®¡ç†é¡µé¢ã€ç­–ç•¥é…ç½®ã€ç”¨æˆ·æƒé™æŸ¥çœ‹</p>
            </div>
        </div>

        <h2 id="architecture">ğŸ—ï¸ 2. ç³»ç»Ÿæ¶æ„</h2>
        
        <div class="architecture">
            <h3>æƒé™æ§åˆ¶ç³»ç»Ÿæ¶æ„å›¾</h3>
            <div style="font-family: monospace; text-align: left; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 5px; margin: 20px 0;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>
â”‚                    æƒé™æ§åˆ¶ç³»ç»Ÿæ¶æ„                           â”‚<br>
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<br>
â”‚  å‰ç«¯ç®¡ç†ç•Œé¢                                                â”‚<br>
â”‚  â”œâ”€â”€ ç­–ç•¥ç®¡ç† (æ·»åŠ /åˆ é™¤æƒé™ç­–ç•¥)                            â”‚<br>
â”‚  â”œâ”€â”€ è§’è‰²ç®¡ç† (ç”¨æˆ·è§’è‰²åˆ†é…)                                 â”‚<br>
â”‚  â””â”€â”€ ç”¨æˆ·æƒé™æŸ¥çœ‹ (æƒé™å’Œè§’è‰²å±•ç¤º)                          â”‚<br>
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<br>
â”‚  API æ¥å£å±‚                                                 â”‚<br>
â”‚  â”œâ”€â”€ æƒé™ç®¡ç† API (/api/v1/casbin/)                        â”‚<br>
â”‚  â””â”€â”€ ç°æœ‰ API + æƒé™éªŒè¯ä¸­é—´ä»¶                               â”‚<br>
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<br>
â”‚  æƒé™æ§åˆ¶æ ¸å¿ƒ                                                â”‚<br>
â”‚  â”œâ”€â”€ Casbin ç®¡ç†å™¨ (ç­–ç•¥æ‰§è¡Œå¼•æ“)                           â”‚<br>
â”‚  â”œâ”€â”€ RBAC æ¨¡å‹é…ç½® (æƒé™æ¨¡å‹å®šä¹‰)                          â”‚<br>
â”‚  â””â”€â”€ æƒé™éªŒè¯ä¸­é—´ä»¶ (è¯·æ±‚æ‹¦æˆªå’ŒéªŒè¯)                        â”‚<br>
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤<br>
â”‚  æ•°æ®å­˜å‚¨å±‚                                                 â”‚<br>
â”‚  â””â”€â”€ æƒé™ç­–ç•¥æ•°æ®åº“å­˜å‚¨ (Gorm é€‚é…å™¨)                       â”‚<br>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
        </div>

        <h2 id="implementation">âš™ï¸ 3. è¯¦ç»†å®ç°è¿‡ç¨‹</h2>

        <div class="step">
            <div class="step-number">1</div>
            <h3>å¼•å…¥ Casbin ä¾èµ–</h3>
            <p>é¦–å…ˆæ·»åŠ  Casbin ç›¸å…³çš„ Go æ¨¡å—ä¾èµ–ï¼š</p>
            <pre><code>go get github.com/casbin/casbin/v2
go get github.com/casbin/gorm-adapter/v3</code></pre>
        </div>

        <div class="step">
            <div class="step-number">2</div>
            <h3>åˆ›å»º RBAC æƒé™æ¨¡å‹</h3>
            <p>åœ¨ <code>config/rbac_model.conf</code> ä¸­å®šä¹‰æƒé™æ¨¡å‹ï¼š</p>
            <pre><code>[request_definition]
r = sub, dom, obj, act

[policy_definition]
p = sub, dom, obj, act

[role_definition]
g = _, _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g(r.sub, p.sub, r.dom) && r.dom == p.dom && r.obj == p.obj && r.act == p.act</code></pre>
            <div class="info">
                <strong>æ¨¡å‹è¯´æ˜ï¼š</strong>
                <ul>
                    <li><strong>sub</strong>: ä¸»ä½“ï¼ˆç”¨æˆ·æˆ–è§’è‰²ï¼‰</li>
                    <li><strong>dom</strong>: åŸŸï¼ˆé¡¹ç›®IDæˆ–å…¨å±€åŸŸï¼‰</li>
                    <li><strong>obj</strong>: å¯¹è±¡ï¼ˆèµ„æºç±»å‹ï¼‰</li>
                    <li><strong>act</strong>: åŠ¨ä½œï¼ˆæ“ä½œç±»å‹ï¼‰</li>
                </ul>
            </div>
        </div>

        <div class="step">
            <div class="step-number">3</div>
            <h3>å®ç° Casbin ç®¡ç†å™¨</h3>
            <p>åˆ›å»º <code>internal/casbin/manager.go</code>ï¼Œæä¾›æƒé™ç®¡ç†æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
            <pre><code>// ä¸»è¦åŠŸèƒ½
- NewCasbinManager()     // åˆå§‹åŒ–ç®¡ç†å™¨
- CheckPermission()      // æƒé™æ£€æŸ¥
- AddPolicy()           // æ·»åŠ ç­–ç•¥
- RemovePolicy()        // åˆ é™¤ç­–ç•¥
- AddRoleForUser()      // æ·»åŠ ç”¨æˆ·è§’è‰²
- DeleteRoleForUser()   // åˆ é™¤ç”¨æˆ·è§’è‰²
- GetPermissionsForUser() // è·å–ç”¨æˆ·æƒé™
- InitializeDefaultPolicies() // åˆå§‹åŒ–é»˜è®¤ç­–ç•¥</code></pre>
        </div>

        <div class="step">
            <div class="step-number">4</div>
            <h3>åˆ›å»ºæƒé™éªŒè¯ä¸­é—´ä»¶</h3>
            <p>åœ¨ <code>api/middleware/casbin_middleware.go</code> ä¸­å®ç°æƒé™ä¸­é—´ä»¶ï¼š</p>
            <pre><code>// ä¸­é—´ä»¶ç±»å‹
- RequirePermission(object, action)  // ç‰¹å®šæƒé™éªŒè¯
- RequireAnyPermission(permissions)  // ä»»ä¸€æƒé™éªŒè¯
- RequireRole(role)                  // è§’è‰²éªŒè¯
- RequireAnyRole(roles)              // ä»»ä¸€è§’è‰²éªŒè¯

// æ™ºèƒ½åŸŸæå–
- ä» URL å‚æ•°æå–é¡¹ç›®IDä½œä¸ºåŸŸ
- ä»æŸ¥è¯¢å‚æ•°è·å–åŸŸä¿¡æ¯
- é»˜è®¤ä½¿ç”¨å…¨å±€åŸŸ "*"</code></pre>
        </div>

        <div class="step">
            <div class="step-number">5</div>
            <h3>å®ç°æƒé™ç®¡ç† API</h3>
            <p>åˆ›å»º <code>api/controller/casbin_controller.go</code>ï¼Œæä¾›å®Œæ•´çš„æƒé™ç®¡ç†æ¥å£ã€‚</p>
        </div>

        <div class="step">
            <div class="step-number">6</div>
            <h3>é…ç½®è·¯ç”±å’Œæƒé™ä¿æŠ¤</h3>
            <p>åœ¨ <code>api/route/route.go</code> ä¸­é›†æˆæƒé™éªŒè¯ä¸­é—´ä»¶åˆ°æ‰€æœ‰ç°æœ‰è·¯ç”±ã€‚</p>
        </div>

        <div class="step">
            <div class="step-number">7</div>
            <h3>åˆ›å»ºå‰ç«¯æƒé™ç®¡ç†é¡µé¢</h3>
            <p>å®ç° <code>frontend/src/pages/permissions.tsx</code>ï¼Œæä¾›å¯è§†åŒ–çš„æƒé™é…ç½®ç•Œé¢ã€‚</p>
        </div>

        <h2 id="files">ğŸ“ 4. å…³é”®æ–‡ä»¶è¯´æ˜</h2>

        <div class="file-tree">
é¡¹ç›®ç»“æ„:
pkms/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ rbac_model.conf              # Casbin RBAC æƒé™æ¨¡å‹é…ç½®
â”œâ”€â”€ internal/
â”‚   â””â”€â”€ casbin/
â”‚       â””â”€â”€ manager.go               # Casbin æƒé™ç®¡ç†å™¨æ ¸å¿ƒ
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â””â”€â”€ casbin_controller.go     # æƒé™ç®¡ç† API æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ casbin_middleware.go     # æƒé™éªŒè¯ä¸­é—´ä»¶
â”‚   â””â”€â”€ route/
â”‚       â”œâ”€â”€ casbin_route.go          # æƒé™ç®¡ç†è·¯ç”±
â”‚       â””â”€â”€ route.go                 # ä¸»è·¯ç”±ï¼ˆå·²é›†æˆæƒé™éªŒè¯ï¼‰
â””â”€â”€ frontend/src/
    â”œâ”€â”€ pages/
    â”‚   â””â”€â”€ permissions.tsx          # å‰ç«¯æƒé™ç®¡ç†é¡µé¢
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ routes.ts                # å‰ç«¯è·¯ç”±é…ç½®
    â””â”€â”€ components/
        â””â”€â”€ sidebar.tsx              # å¯¼èˆªæ ï¼ˆæ·»åŠ æƒé™ç®¡ç†èœå•ï¼‰
        </div>

        <h3>æ ¸å¿ƒæ–‡ä»¶è¯¦ç»†è¯´æ˜</h3>

        <h4>ğŸ”§ config/rbac_model.conf</h4>
        <div class="info">
            <p>å®šä¹‰äº†åŸºäºåŸŸçš„ RBAC æƒé™æ¨¡å‹ï¼Œæ”¯æŒå››å…ƒç»„æƒé™æ§åˆ¶ï¼ˆç”¨æˆ·-åŸŸ-å¯¹è±¡-åŠ¨ä½œï¼‰ã€‚</p>
        </div>

        <h4>ğŸ”§ internal/casbin/manager.go</h4>
        <div class="info">
            <p>æƒé™ç®¡ç†çš„æ ¸å¿ƒç»„ä»¶ï¼Œæä¾›ï¼š</p>
            <ul>
                <li>Casbin enforcer çš„åˆå§‹åŒ–å’Œé…ç½®</li>
                <li>æƒé™ç­–ç•¥çš„ CRUD æ“ä½œ</li>
                <li>ç”¨æˆ·è§’è‰²ç®¡ç†</li>
                <li>æƒé™æ£€æŸ¥å’ŒéªŒè¯</li>
                <li>é»˜è®¤ç­–ç•¥åˆå§‹åŒ–</li>
            </ul>
        </div>

        <h4>ğŸ”§ api/middleware/casbin_middleware.go</h4>
        <div class="info">
            <p>æƒé™éªŒè¯ä¸­é—´ä»¶ï¼Œæä¾›ï¼š</p>
            <ul>
                <li>å¤šç§æƒé™éªŒè¯æ–¹å¼</li>
                <li>æ™ºèƒ½åŸŸæå–</li>
                <li>çµæ´»çš„æƒé™æ§åˆ¶</li>
                <li>ç”¨æˆ·å‹å¥½çš„é”™è¯¯å“åº”</li>
            </ul>
        </div>

        <h2 id="api">ğŸ”Œ 5. API æ¥å£æ–‡æ¡£</h2>

        <h3>æƒé™ç®¡ç† APIï¼ˆ/api/v1/casbin/ï¼‰</h3>

        <div class="api-endpoint">
            <strong>POST</strong> /policies
            <p>æ·»åŠ æƒé™ç­–ç•¥</p>
            <pre><code>{
  "user_id": "user123",
  "domain": "*",
  "object": "project",
  "action": "view"
}</code></pre>
        </div>

        <div class="api-endpoint">
            <strong>DELETE</strong> /policies
            <p>åˆ é™¤æƒé™ç­–ç•¥</p>
            <pre><code>{
  "user_id": "user123",
  "domain": "*", 
  "object": "project",
  "action": "view"
}</code></pre>
        </div>

        <div class="api-endpoint">
            <strong>GET</strong> /policies?page=1&limit=100
            <p>æŸ¥è¯¢æ‰€æœ‰ç­–ç•¥ï¼ˆæ”¯æŒåˆ†é¡µï¼‰</p>
        </div>

        <div class="api-endpoint">
            <strong>POST</strong> /policies/check
            <p>æ£€æŸ¥ç”¨æˆ·æƒé™</p>
            <pre><code>{
  "user_id": "user123",
  "domain": "*",
  "object": "project", 
  "action": "view"
}</code></pre>
        </div>

        <div class="api-endpoint">
            <strong>POST</strong> /roles
            <p>æ·»åŠ ç”¨æˆ·è§’è‰²</p>
            <pre><code>{
  "user_id": "user123",
  "role": "developer",
  "domain": "*"
}</code></pre>
        </div>

        <div class="api-endpoint">
            <strong>GET</strong> /users/:user_id/permissions?domain=*
            <p>æŸ¥è¯¢ç”¨æˆ·æƒé™å’Œè§’è‰²</p>
        </div>

        <div class="api-endpoint">
            <strong>POST</strong> /initialize
            <p>åˆå§‹åŒ–é»˜è®¤ç­–ç•¥ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p>
        </div>

        <h3>é»˜è®¤è§’è‰²å’Œæƒé™ç­–ç•¥</h3>

        <table>
            <thead>
                <tr>
                    <th>è§’è‰²</th>
                    <th>æè¿°</th>
                    <th>æƒé™ç¤ºä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>admin</strong></td>
                    <td>ç³»ç»Ÿç®¡ç†å‘˜</td>
                    <td>admin,*,*,* (æ‰€æœ‰æƒé™)</td>
                </tr>
                <tr>
                    <td><strong>project_admin</strong></td>
                    <td>é¡¹ç›®ç®¡ç†å‘˜</td>
                    <td>project_admin,*,project,* <br> project_admin,*,package,*</td>
                </tr>
                <tr>
                    <td><strong>developer</strong></td>
                    <td>å¼€å‘è€…</td>
                    <td>developer,*,package,view <br> developer,*,package,create</td>
                </tr>
                <tr>
                    <td><strong>viewer</strong></td>
                    <td>æŸ¥çœ‹è€…</td>
                    <td>viewer,*,project,view <br> viewer,*,package,view</td>
                </tr>
            </tbody>
        </table>

        <h2 id="frontend">ğŸ¨ 6. å‰ç«¯å®ç°</h2>

        <h3>æƒé™ç®¡ç†é¡µé¢åŠŸèƒ½</h3>

        <div class="feature-grid">
            <div class="feature-card">
                <h4>ğŸ“‹ ç­–ç•¥ç®¡ç†</h4>
                <ul>
                    <li>å¯è§†åŒ–æ·»åŠ æƒé™ç­–ç•¥</li>
                    <li>ç­–ç•¥åˆ—è¡¨å±•ç¤ºå’Œåˆ é™¤</li>
                    <li>æ”¯æŒç”¨æˆ·ã€åŸŸã€å¯¹è±¡ã€åŠ¨ä½œçš„é…ç½®</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>ğŸ‘¥ è§’è‰²ç®¡ç†</h4>
                <ul>
                    <li>ç”¨æˆ·è§’è‰²åˆ†é…ç•Œé¢</li>
                    <li>è§’è‰²åˆ—è¡¨å±•ç¤ºå’Œåˆ é™¤</li>
                    <li>æ”¯æŒå¤šè§’è‰²åˆ†é…</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>ğŸ” ç”¨æˆ·æƒé™æŸ¥çœ‹</h4>
                <ul>
                    <li>æŸ¥çœ‹ç”¨æˆ·çš„æ‰€æœ‰æƒé™</li>
                    <li>æŸ¥çœ‹ç”¨æˆ·çš„è§’è‰²ä¿¡æ¯</li>
                    <li>æŒ‰åŸŸè¿‡æ»¤æƒé™ä¿¡æ¯</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>âš™ï¸ ç³»ç»Ÿç®¡ç†</h4>
                <ul>
                    <li>ä¸€é”®åˆå§‹åŒ–é»˜è®¤ç­–ç•¥</li>
                    <li>æƒé™ç­–ç•¥é‡æ–°åŠ è½½</li>
                    <li>ç³»ç»ŸçŠ¶æ€æŸ¥çœ‹</li>
                </ul>
            </div>
        </div>

        <h3>é¡µé¢æˆªå›¾æ•ˆæœ</h3>
        <div class="info">
            <p>æƒé™ç®¡ç†é¡µé¢åŒ…å«ä¸‰ä¸ªä¸»è¦æ ‡ç­¾é¡µï¼š</p>
            <ul>
                <li><strong>ç­–ç•¥ç®¡ç†</strong>ï¼šè¡¨æ ¼å±•ç¤ºæ‰€æœ‰æƒé™ç­–ç•¥ï¼Œæ”¯æŒæ·»åŠ å’Œåˆ é™¤</li>
                <li><strong>è§’è‰²ç®¡ç†</strong>ï¼šè¡¨æ ¼å±•ç¤ºç”¨æˆ·è§’è‰²åˆ†é…ï¼Œæ”¯æŒè§’è‰²ç®¡ç†</li>
                <li><strong>ç”¨æˆ·æƒé™</strong>ï¼šæŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„æƒé™å’Œè§’è‰²ä¿¡æ¯</li>
            </ul>
        </div>

        <h2 id="usage">ğŸ“– 7. ä½¿ç”¨è¯´æ˜</h2>

        <h3>å¿«é€Ÿå¼€å§‹</h3>

        <div class="step">
            <div class="step-number">1</div>
            <h4>å¯åŠ¨ç³»ç»Ÿ</h4>
            <pre><code># æ„å»ºå¹¶å¯åŠ¨åº”ç”¨
go build -o pkms cmd/main.go
./pkms</code></pre>
        </div>

        <div class="step">
            <div class="step-number">2</div>
            <h4>åˆå§‹åŒ–æƒé™</h4>
            <p>è®¿é—® <code>http://localhost:8080/permissions</code>ï¼Œç‚¹å‡»"åˆå§‹åŒ–é»˜è®¤ç­–ç•¥"æŒ‰é’®</p>
        </div>

        <div class="step">
            <div class="step-number">3</div>
            <h4>é…ç½®ç”¨æˆ·è§’è‰²</h4>
            <p>ä½¿ç”¨å‰ç«¯ç•Œé¢æˆ– API ä¸ºç”¨æˆ·åˆ†é…è§’è‰²ï¼š</p>
            <pre><code>curl -X POST http://localhost:8080/api/v1/casbin/roles \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "user_id": "user123",
    "role": "developer", 
    "domain": "*"
  }'</code></pre>
        </div>

        <div class="step">
            <div class="step-number">4</div>
            <h4>æµ‹è¯•æƒé™</h4>
            <p>å°è¯•è®¿é—®éœ€è¦æƒé™çš„ API æ¥å£ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œæƒé™éªŒè¯ã€‚</p>
        </div>

        <h3>å¸¸ç”¨æ“ä½œç¤ºä¾‹</h3>

        <h4>ğŸ”¸ æ·»åŠ è‡ªå®šä¹‰æƒé™ç­–ç•¥</h4>
        <pre><code>curl -X POST http://localhost:8080/api/v1/casbin/policies \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "user_id": "user123",
    "domain": "project_001",
    "object": "package",
    "action": "edit"
  }'</code></pre>

        <h4>ğŸ”¸ æ£€æŸ¥ç”¨æˆ·æƒé™</h4>
        <pre><code>curl -X POST http://localhost:8080/api/v1/casbin/policies/check \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "user_id": "user123",
    "domain": "*",
    "object": "project",
    "action": "view"
  }'</code></pre>

        <h4>ğŸ”¸ æŸ¥çœ‹ç”¨æˆ·æ‰€æœ‰æƒé™</h4>
        <pre><code>curl -X GET "http://localhost:8080/api/v1/casbin/users/user123/permissions?domain=*" \
  -H "Authorization: Bearer YOUR_TOKEN"</code></pre>

        <h2 id="deployment">ğŸš€ 8. éƒ¨ç½²æŒ‡å—</h2>

        <div class="warning">
            <h4>âš ï¸ éƒ¨ç½²æ³¨æ„äº‹é¡¹</h4>
            <ul>
                <li><strong>æ•°æ®åº“é…ç½®</strong>ï¼šç¡®ä¿æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²æ­£ç¡®é…ç½®</li>
                <li><strong>æƒé™æ¨¡å‹æ–‡ä»¶</strong>ï¼šç¡®ä¿ <code>config/rbac_model.conf</code> æ–‡ä»¶å¯è®¿é—®</li>
                <li><strong>åˆå§‹åŒ–ç­–ç•¥</strong>ï¼šé¦–æ¬¡éƒ¨ç½²æ—¶éœ€è¦æ‰§è¡Œç­–ç•¥åˆå§‹åŒ–</li>
                <li><strong>ç®¡ç†å‘˜è´¦æˆ·</strong>ï¼šç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·</li>
            </ul>
        </div>

        <h3>ç”Ÿäº§ç¯å¢ƒé…ç½®å»ºè®®</h3>

        <div class="info">
            <h4>ğŸ”¹ ç¯å¢ƒå˜é‡é…ç½®</h4>
            <pre><code># .env æ–‡ä»¶ç¤ºä¾‹
DB_PATH=./data/pkms.db
ACCESS_TOKEN_SECRET=your-secret-key
ADMIN_USERNAME=admin
ADMIN_PASSWORD=secure-password</code></pre>
        </div>

        <div class="info">
            <h4>ğŸ”¹ æƒé™ç­–ç•¥å¤‡ä»½</h4>
            <p>å»ºè®®å®šæœŸå¤‡ä»½æƒé™ç­–ç•¥æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š</p>
            <ul>
                <li>å¯¼å‡ºç­–ç•¥ï¼š<code>GET /api/v1/casbin/policies</code></li>
                <li>å¯¼å‡ºè§’è‰²ï¼š<code>GET /api/v1/casbin/roles</code></li>
                <li>æ•°æ®åº“å¤‡ä»½ï¼šå®šæœŸå¤‡ä»½ Casbin ç­–ç•¥è¡¨</li>
            </ul>
        </div>

        <h2 id="summary">ğŸ“‹ 9. æ€»ç»“</h2>

        <div class="highlight">
            <h3>ğŸ‰ å®ç°æˆæœ</h3>
            <p>æœ¬æ¬¡ Casbin æƒé™æ§åˆ¶ç³»ç»Ÿçš„å®ç°ä¸º PKMS é¡¹ç›®å¸¦æ¥äº†ä»¥ä¸‹æ”¹è¿›ï¼š</p>
            <ul>
                <li><strong>å®‰å…¨æ€§æå‡</strong>ï¼šæ‰€æœ‰ API æ¥å£éƒ½æœ‰æƒé™ä¿æŠ¤</li>
                <li><strong>ç®¡ç†ä¾¿åˆ©æ€§</strong>ï¼šå¯è§†åŒ–çš„æƒé™é…ç½®ç•Œé¢</li>
                <li><strong>æ‰©å±•æ€§å¼º</strong>ï¼šçµæ´»çš„æƒé™æ¨¡å‹ï¼Œæ˜“äºæ‰©å±•</li>
                <li><strong>ä¼ä¸šçº§ç‰¹æ€§</strong>ï¼šæ”¯æŒå¤æ‚çš„æƒé™ç®¡ç†éœ€æ±‚</li>
            </ul>
        </div>

        <h3>ç³»ç»Ÿç‰¹æ€§æ€»è§ˆ</h3>

        <table>
            <thead>
                <tr>
                    <th>ç‰¹æ€§</th>
                    <th>æè¿°</th>
                    <th>çŠ¶æ€</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ç»†ç²’åº¦æƒé™æ§åˆ¶</td>
                    <td>æ”¯æŒèµ„æºçº§åˆ«çš„æƒé™ç®¡ç†</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
                <tr>
                    <td>çµæ´»çš„è§’è‰²ç®¡ç†</td>
                    <td>æ”¯æŒå¤šå±‚çº§è§’è‰²ç»§æ‰¿</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
                <tr>
                    <td>åŸŸéš”ç¦»</td>
                    <td>æ”¯æŒé¡¹ç›®çº§åˆ«çš„æƒé™éš”ç¦»</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
                <tr>
                    <td>åŠ¨æ€æƒé™æ›´æ–°</td>
                    <td>è¿è¡Œæ—¶æƒé™æ›´æ–°ï¼Œæ— éœ€é‡å¯</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
                <tr>
                    <td>å¯è§†åŒ–ç®¡ç†</td>
                    <td>å‹å¥½çš„å‰ç«¯ç®¡ç†ç•Œé¢</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
                <tr>
                    <td>API å®Œæ•´æ€§</td>
                    <td>æ‰€æœ‰æ¥å£éƒ½æœ‰æƒé™éªŒè¯</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
                <tr>
                    <td>æ•°æ®æŒä¹…åŒ–</td>
                    <td>æƒé™ç­–ç•¥æ•°æ®åº“å­˜å‚¨</td>
                    <td><span class="checkmark">âœ… å®Œæˆ</span></td>
                </tr>
            </tbody>
        </table>

        <h3>åç»­ä¼˜åŒ–å»ºè®®</h3>

        <div class="info">
            <ul>
                <li><strong>å®¡è®¡æ—¥å¿—</strong>ï¼šæ·»åŠ æƒé™æ“ä½œçš„å®¡è®¡æ—¥å¿—åŠŸèƒ½</li>
                <li><strong>æ‰¹é‡æ“ä½œ</strong>ï¼šæ”¯æŒæ‰¹é‡æ·»åŠ /åˆ é™¤æƒé™ç­–ç•¥</li>
                <li><strong>æƒé™æ¨¡æ¿</strong>ï¼šé¢„å®šä¹‰å¸¸ç”¨çš„æƒé™æ¨¡æ¿</li>
                <li><strong>æƒé™ç»§æ‰¿</strong>ï¼šå®ç°æ›´å¤æ‚çš„æƒé™ç»§æ‰¿å…³ç³»</li>
                <li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¯¹äºå¤§é‡ç­–ç•¥çš„æ€§èƒ½ä¼˜åŒ–</li>
            </ul>
        </div>

        <div class="footer">
            <p>ğŸ“„ æœ¬æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2024å¹´ | ğŸ”— PKMS Casbin æƒé™æ§åˆ¶ç³»ç»Ÿå®ç°æŒ‡å—</p>
            <p>ğŸ’¡ å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿ</p>
        </div>
    </div>
</body>
</html> 